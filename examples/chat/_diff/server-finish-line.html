<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Diff to HTML by rtfpessoa</title>

  <!--
      Diff to HTML (template.html)
      Author: rtfpessoa
  -->

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/github.min.css">

  <style>
    .d2h-wrapper {
      text-align: left
    }

    .d2h-file-header {
      padding: 5px 10px;
      border-bottom: 1px solid #d8d8d8;
      background-color: #f7f7f7
    }

    .d2h-file-stats {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      margin-left: auto;
      font-size: 14px
    }

    .d2h-lines-added {
      text-align: right;
      border: 1px solid #b4e2b4;
      border-radius: 5px 0 0 5px;
      color: #399839;
      padding: 2px;
      vertical-align: middle
    }

    .d2h-lines-deleted {
      text-align: left;
      border: 1px solid #e9aeae;
      border-radius: 0 5px 5px 0;
      color: #c33;
      padding: 2px;
      vertical-align: middle;
      margin-left: 1px
    }

    .d2h-file-name-wrapper {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      -webkit-box-align: center;
      -ms-flex-align: center;
      align-items: center;
      width: 100%;
      font-family: "Source Sans Pro", "Helvetica Neue", Helvetica, Arial, sans-serif;
      font-size: 15px
    }

    .d2h-file-name {
      white-space: nowrap;
      text-overflow: ellipsis;
      overflow-x: hidden;
      line-height: 21px
    }

    .d2h-file-diff,
    .d2h-file-side-diff {
      overflow-x: scroll;
      overflow-y: hidden
    }

    .d2h-file-wrapper {
      border: 1px solid #ddd;
      border-radius: 3px;
      margin-bottom: 1em
    }

    .d2h-diff-table {
      width: 100%;
      border-collapse: collapse;
      font-family: Menlo, Consolas, monospace;
      font-size: 13px
    }

    .d2h-diff-tbody>tr>td {
      height: 20px;
      line-height: 20px
    }

    .d2h-files-diff {
      display: block;
      width: 100%;
      height: 100%
    }

    .d2h-file-side-diff {
      display: inline-block;
      width: 50%;
      margin-right: -4px;
      margin-bottom: -8px
    }

    .d2h-code-line {
      display: inline-block;
      white-space: nowrap;
      padding: 0 10px;
      margin-left: 80px
    }

    .d2h-code-side-line {
      display: inline-block;
      white-space: nowrap;
      padding: 0 10px;
      margin-left: 50px
    }

    .d2h-code-line del,
    .d2h-code-side-line del {
      display: inline-block;
      margin-top: -1px;
      text-decoration: none;
      background-color: #ffb6ba;
      border-radius: .2em
    }

    .d2h-code-line ins,
    .d2h-code-side-line ins {
      display: inline-block;
      margin-top: -1px;
      text-decoration: none;
      background-color: #97f295;
      border-radius: .2em;
      text-align: left
    }

    .d2h-code-line-ctn,
    .d2h-code-line-prefix {
      display: inline;
      background: 0 0;
      padding: 0;
      word-wrap: normal;
      white-space: pre
    }

    .d2h-code-linenumber,
    .d2h-code-side-linenumber {
      position: absolute;
      background-color: #fff;
      text-align: right;
      color: rgba(0, 0, 0, .3);
      cursor: pointer
    }

    .line-num1,
    .line-num2 {
      width: 40px;
      padding-left: 3px;
      box-sizing: border-box;
      overflow: hidden;
      text-overflow: ellipsis
    }

    .line-num1 {
      float: left
    }

    .line-num2 {
      float: right
    }

    .d2h-code-linenumber {
      box-sizing: border-box;
      width: 86px;
      padding-left: 2px;
      padding-right: 2px;
      border: solid #eee;
      border-width: 0 1px
    }

    .d2h-code-side-linenumber {
      box-sizing: border-box;
      width: 56px;
      padding-left: 5px;
      padding-right: 5px;
      border: solid #eee;
      border-width: 0 1px;
      overflow: hidden;
      text-overflow: ellipsis
    }

    .d2h-del {
      background-color: #fee8e9;
      border-color: #e9aeae
    }

    .d2h-ins {
      background-color: #dfd;
      border-color: #b4e2b4
    }

    .d2h-info {
      background-color: #f8fafd;
      color: rgba(0, 0, 0, .3);
      border-color: #d5e4f2
    }

    .d2h-file-diff .d2h-del.d2h-change {
      background-color: #fdf2d0
    }

    .d2h-file-diff .d2h-ins.d2h-change {
      background-color: #ded
    }

    .d2h-file-list-wrapper {
      margin-bottom: 10px
    }

    .d2h-file-list-wrapper a {
      text-decoration: none;
      color: #3572b0
    }

    .d2h-file-list-wrapper a:visited {
      color: #3572b0
    }

    .d2h-file-list-header {
      text-align: left
    }

    .d2h-file-list-title {
      font-weight: 700
    }

    .d2h-file-list-line {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      text-align: left
    }

    .d2h-file-list {
      display: block;
      list-style: none;
      padding: 0;
      margin: 0
    }

    .d2h-file-list>li {
      border-bottom: #ddd solid 1px;
      padding: 5px 10px;
      margin: 0
    }

    .d2h-file-list>li:last-child {
      border-bottom: none
    }

    .d2h-file-switch {
      display: none;
      font-size: 10px;
      cursor: pointer
    }

    .d2h-icon-wrapper {
      line-height: 31px
    }

    .d2h-icon {
      vertical-align: middle;
      margin-right: 10px;
      fill: currentColor
    }

    .d2h-deleted {
      color: #c33
    }

    .d2h-added {
      color: #399839
    }

    .d2h-changed {
      color: #d0b44c
    }

    .d2h-moved {
      color: #3572b0
    }

    .d2h-tag {
      display: -webkit-box;
      display: -ms-flexbox;
      display: flex;
      font-size: 10px;
      margin-left: 5px;
      padding: 0 2px;
      background-color: #fff
    }

    .d2h-deleted-tag {
      border: 1px solid #c33
    }

    .d2h-added-tag {
      border: 1px solid #399839
    }

    .d2h-changed-tag {
      border: 1px solid #d0b44c
    }

    .d2h-moved-tag {
      border: 1px solid #3572b0
    }

    .selecting-left .d2h-code-line,
    .selecting-left .d2h-code-line *,
    .selecting-left .d2h-code-side-line,
    .selecting-left .d2h-code-side-line *,
    .selecting-right td.d2h-code-linenumber,
    .selecting-right td.d2h-code-linenumber *,
    .selecting-right td.d2h-code-side-linenumber,
    .selecting-right td.d2h-code-side-linenumber * {
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none
    }

    .selecting-left .d2h-code-line ::-moz-selection,
    .selecting-left .d2h-code-line::-moz-selection,
    .selecting-left .d2h-code-side-line ::-moz-selection,
    .selecting-left .d2h-code-side-line::-moz-selection,
    .selecting-right td.d2h-code-linenumber::-moz-selection,
    .selecting-right td.d2h-code-side-linenumber ::-moz-selection,
    .selecting-right td.d2h-code-side-linenumber::-moz-selection {
      background: 0 0
    }

    .selecting-left .d2h-code-line ::selection,
    .selecting-left .d2h-code-line::selection,
    .selecting-left .d2h-code-side-line ::selection,
    .selecting-left .d2h-code-side-line::selection,
    .selecting-right td.d2h-code-linenumber::selection,
    .selecting-right td.d2h-code-side-linenumber ::selection,
    .selecting-right td.d2h-code-side-linenumber::selection {
      background: 0 0
    }
  </style>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.3/jquery.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/languages/scala.min.js"></script>

  <script>
    !function e(t, n, r) { function s(o, u) { if (!n[o]) { if (!t[o]) { var a = "function" == typeof require && require; if (!u && a) return a(o, !0); if (i) return i(o, !0); var f = new Error("Cannot find module '" + o + "'"); throw f.code = "MODULE_NOT_FOUND", f } var l = n[o] = { exports: {} }; t[o][0].call(l.exports, function (e) { var n = t[o][1][e]; return s(n ? n : e) }, l, l.exports, e, t, n, r) } return n[o].exports } for (var i = "function" == typeof require && require, o = 0; o < r.length; o++)s(r[o]); return s }({ 1: [function (require, module) { (function (global) { !function () { function Diff2HtmlUI(config) { var cfg = config || {}; cfg.diff ? diffJson = Diff2Html.getJsonFromDiff(cfg.diff) : cfg.json && (diffJson = cfg.json), this._initSelection() } function synchronisedScroll($target, config) { config.synchronisedScroll && $target.find(".d2h-file-side-diff").scroll(function () { var $this = $(this); $this.closest(".d2h-file-wrapper").find(".d2h-file-side-diff").scrollLeft($this.scrollLeft()) }) } var highlightJS = require("./highlight.js-internals.js").HighlightJS, diffJson = null, defaultTarget = "body", currentSelectionColumnId = -1; Diff2HtmlUI.prototype.draw = function (targetId, config) { var cfg = config || {}; cfg.inputFormat = "json"; var $target = this._getTarget(targetId); $target.html(Diff2Html.getPrettyHtml(diffJson, cfg)), synchronisedScroll($target, cfg) }, Diff2HtmlUI.prototype.fileListCloseable = function (targetId, startVisible) { function show() { $showBtn.hide(), $hideBtn.show(), $fileList.show() } function hide() { $hideBtn.hide(), $showBtn.show(), $fileList.hide() } var $target = this._getTarget(targetId), hashTag = this._getHashTag(), $showBtn = $target.find(".d2h-show"), $hideBtn = $target.find(".d2h-hide"), $fileList = $target.find(".d2h-file-list"); "files-summary-show" === hashTag ? show() : "files-summary-hide" === hashTag ? hide() : startVisible ? show() : hide(), $showBtn.click(show), $hideBtn.click(hide) }, Diff2HtmlUI.prototype.highlightCode = function (targetId) { var that = this, $target = that._getTarget(targetId), $files = $target.find(".d2h-file-wrapper"); $files.map(function (_i, file) { var oldLinesState, newLinesState, $file = $(file), language = $file.data("lang"), $codeLines = $file.find(".d2h-code-line-ctn"); $codeLines.map(function (_j, line) { var lineState, $line = $(line), text = line.textContent, lineParent = line.parentNode; lineState = -1 !== lineParent.className.indexOf("d2h-del") ? oldLinesState : newLinesState; var result = hljs.getLanguage(language) ? hljs.highlight(language, text, !0, lineState) : hljs.highlightAuto(text); -1 !== lineParent.className.indexOf("d2h-del") ? oldLinesState = result.top : -1 !== lineParent.className.indexOf("d2h-ins") ? newLinesState = result.top : (oldLinesState = result.top, newLinesState = result.top); var originalStream = highlightJS.nodeStream(line); if (originalStream.length) { var resultNode = document.createElementNS("http://www.w3.org/1999/xhtml", "div"); resultNode.innerHTML = result.value, result.value = highlightJS.mergeStreams(originalStream, highlightJS.nodeStream(resultNode), text) } $line.addClass("hljs"), $line.addClass(result.language), $line.html(result.value) }) }) }, Diff2HtmlUI.prototype._getTarget = function (targetId) { var $target; return "object" == typeof targetId && targetId instanceof jQuery ? $target = targetId : "string" == typeof targetId ? $target = $(targetId) : (console.error("Wrong target provided! Falling back to default value 'body'."), console.log("Please provide a jQuery object or a valid DOM query string."), $target = $(defaultTarget)), $target }, Diff2HtmlUI.prototype._getHashTag = function () { var docUrl = document.URL, hashTagIndex = docUrl.indexOf("#"), hashTag = null; return -1 !== hashTagIndex && (hashTag = docUrl.substr(hashTagIndex + 1)), hashTag }, Diff2HtmlUI.prototype._distinct = function (collection) { return collection.filter(function (v, i) { return collection.indexOf(v) === i }) }, Diff2HtmlUI.prototype._initSelection = function () { var body = $("body"), that = this; body.on("mousedown", ".d2h-diff-table", function (event) { var target = $(event.target), table = target.closest(".d2h-diff-table"); target.closest(".d2h-code-line,.d2h-code-side-line").length ? (table.removeClass("selecting-left"), table.addClass("selecting-right"), currentSelectionColumnId = 1) : target.closest(".d2h-code-linenumber,.d2h-code-side-linenumber").length && (table.removeClass("selecting-right"), table.addClass("selecting-left"), currentSelectionColumnId = 0) }), body.on("copy", ".d2h-diff-table", function (event) { var clipboardData = event.originalEvent.clipboardData, text = that._getSelectedText(); clipboardData.setData("text", text), event.preventDefault() }) }, Diff2HtmlUI.prototype._getSelectedText = function () { var sel = window.getSelection(), range = sel.getRangeAt(0), doc = range.cloneContents(), nodes = doc.querySelectorAll("tr"), text = "", idx = currentSelectionColumnId; return 0 === nodes.length ? text = doc.textContent : [].forEach.call(nodes, function (tr, i) { var td = tr.cells[1 === tr.cells.length ? 0 : idx]; text += (i ? "\n" : "") + td.textContent.replace(/(?:\r\n|\r|\n)/g, "") }), text }, module.exports.Diff2HtmlUI = Diff2HtmlUI, global.Diff2HtmlUI = Diff2HtmlUI }() }).call(this, "undefined" != typeof global ? global : "undefined" != typeof self ? self : "undefined" != typeof window ? window : {}) }, { "./highlight.js-internals.js": 2 }], 2: [function (require, module) { !function () { function HighlightJS() { } function escape(value) { return value.replace(/&/gm, "&amp;").replace(/</gm, "&lt;").replace(/>/gm, "&gt;") } function tag(node) { return node.nodeName.toLowerCase() } HighlightJS.prototype.nodeStream = function (node) { var result = []; return function _nodeStream(node, offset) { for (var child = node.firstChild; child; child = child.nextSibling)3 === child.nodeType ? offset += child.nodeValue.length : 1 === child.nodeType && (result.push({ event: "start", offset: offset, node: child }), offset = _nodeStream(child, offset), tag(child).match(/br|hr|img|input/) || result.push({ event: "stop", offset: offset, node: child })); return offset }(node, 0), result }, HighlightJS.prototype.mergeStreams = function (original, highlighted, value) { function selectStream() { return original.length && highlighted.length ? original[0].offset !== highlighted[0].offset ? original[0].offset < highlighted[0].offset ? original : highlighted : "start" === highlighted[0].event ? original : highlighted : original.length ? original : highlighted } function open(node) { function attrStr(a) { return " " + a.nodeName + '="' + escape(a.value) + '"' } result += "<" + tag(node) + Array.prototype.map.call(node.attributes, attrStr).join("") + ">" } function close(node) { result += "</" + tag(node) + ">" } function render(event) { ("start" === event.event ? open : close)(event.node) } for (var processed = 0, result = "", nodeStack = []; original.length || highlighted.length;) { var stream = selectStream(); if (result += escape(value.substr(processed, stream[0].offset - processed)), processed = stream[0].offset, stream === original) { nodeStack.reverse().forEach(close); do render(stream.splice(0, 1)[0]), stream = selectStream(); while (stream === original && stream.length && stream[0].offset === processed); nodeStack.reverse().forEach(open) } else "start" === stream[0].event ? nodeStack.push(stream[0].node) : nodeStack.pop(), render(stream.splice(0, 1)[0]) } return result + escape(value.substr(processed)) }, module.exports.HighlightJS = new HighlightJS }() }, {}] }, {}, [1]);
  </script>

  <script>
    $(document).ready(function () {
      var diff2htmlUi = new Diff2HtmlUI();
      diff2htmlUi.fileListCloseable("#diff", undefined);
      diff2htmlUi.highlightCode('#diff');
    });
  </script>
</head>

<body style="text-align: center; font-family: 'Source Sans Pro',sans-serif;">
  <h1>Diff to HTML by
    <a href="https://github.com/rtfpessoa">rtfpessoa</a>
  </h1>

  <div id="diff">
    <div class="d2h-wrapper">
      <div id="d2h-713428" class="d2h-file-wrapper" data-lang="848000000 -0500">
        <div class="d2h-file-header">
          <span class="d2h-file-name-wrapper">
            <span class="d2h-icon-wrapper">
              <svg aria-hidden="true" class="d2h-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12">
                <path d="M6 5H2v-1h4v1zM2 8h7v-1H2v1z m0 2h7v-1H2v1z m0 2h7v-1H2v1z m10-7.5v9.5c0 0.55-0.45 1-1 1H1c-0.55 0-1-0.45-1-1V2c0-0.55 0.45-1 1-1h7.5l3.5 3.5z m-1 0.5L8 2H1v12h10V5z"></path>
              </svg>
            </span>
            <span class="d2h-file-name">server/{client/src/services/message/hooks/index.js 2017-01-01 15:22:15.104000000 -0500 → finish/src/services/message/hooks/index.js
              2017-01-15 15:14:05.848000000 -0500}</span>
            <span class="d2h-tag d2h-moved d2h-moved-tag">RENAMED</span>
          </span>
        </div>
        <div class="d2h-file-diff">
          <div class="d2h-code-wrapper">
            <table class="d2h-diff-table">
              <tbody class="d2h-diff-tbody">
                <tr>
                  <td class="d2h-code-linenumber d2h-info"></td>
                  <td class="d2h-info">
                    <div class="d2h-code-line d2h-info">@@ -4,6 +4,28 @@</div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-cntx">
                    <div class="line-num1">4</div>
                    <div class="line-num2">4</div>
                  </td>
                  <td class="d2h-cntx">
                    <div class="d2h-code-line d2h-cntx">
                      <span class="d2h-code-line-prefix"> </span>
                      <span class="d2h-code-line-ctn">const hooks = require('feathers-hooks');</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-cntx">
                    <div class="line-num1">5</div>
                    <div class="line-num2">5</div>
                  </td>
                  <td class="d2h-cntx">
                    <div class="d2h-code-line d2h-cntx">
                      <span class="d2h-code-line-prefix"> </span>
                      <span class="d2h-code-line-ctn">const auth = require('feathers-authentication').hooks;</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-cntx">
                    <div class="line-num1">6</div>
                    <div class="line-num2">6</div>
                  </td>
                  <td class="d2h-cntx">
                    <div class="d2h-code-line d2h-cntx">
                      <span class="d2h-code-line-prefix"> </span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">7</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn">const restrictToSender = require('./restrict-to-sender');</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">8</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn">const process = require('./process');</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">9</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn">const { setCreatedAt, populate, dePopulate, serialize } = require('feathers-hooks-common');</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">10</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">11</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn">const restrictToSenderOrServer = when(isProvider('external'), restrictToSender());</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">12</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">13</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn">const populateSchema = {</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">14</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn"> include: [{</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">15</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn"> service: 'users',</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">16</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn"> nameAs: 'sentBy',</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">17</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn"> parentField: 'userId',</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">18</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn"> childField: '_id'</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">19</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn"> }]</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">20</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn">};</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">21</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">22</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn">const serializeSchema = {</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">23</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn"> only: [ '_id', 'text', 'createdAt' ],</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">24</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn"> sentBy: {</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">25</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn"> only: [ 'email', 'avatar' ]</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">26</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn"> }</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">27</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn">};</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">28</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-cntx">
                    <div class="line-num1">7</div>
                    <div class="line-num2">29</div>
                  </td>
                  <td class="d2h-cntx">
                    <div class="d2h-code-line d2h-cntx">
                      <span class="d2h-code-line-prefix"> </span>
                      <span class="d2h-code-line-ctn">exports.before = {</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-cntx">
                    <div class="line-num1">8</div>
                    <div class="line-num2">30</div>
                  </td>
                  <td class="d2h-cntx">
                    <div class="d2h-code-line d2h-cntx">
                      <span class="d2h-code-line-prefix"> </span>
                      <span class="d2h-code-line-ctn"> all: [</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-cntx">
                    <div class="line-num1">9</div>
                    <div class="line-num2">31</div>
                  </td>
                  <td class="d2h-cntx">
                    <div class="d2h-code-line d2h-cntx">
                      <span class="d2h-code-line-prefix"> </span>
                      <span class="d2h-code-line-ctn"> auth.verifyToken(),</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-info"></td>
                  <td class="d2h-info">
                    <div class="d2h-code-line d2h-info">@@ -12,17 +34,17 @@</div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-cntx">
                    <div class="line-num1">12</div>
                    <div class="line-num2">34</div>
                  </td>
                  <td class="d2h-cntx">
                    <div class="d2h-code-line d2h-cntx">
                      <span class="d2h-code-line-prefix"> </span>
                      <span class="d2h-code-line-ctn"> ],</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-cntx">
                    <div class="line-num1">13</div>
                    <div class="line-num2">35</div>
                  </td>
                  <td class="d2h-cntx">
                    <div class="d2h-code-line d2h-cntx">
                      <span class="d2h-code-line-prefix"> </span>
                      <span class="d2h-code-line-ctn"> find: [],</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-cntx">
                    <div class="line-num1">14</div>
                    <div class="line-num2">36</div>
                  </td>
                  <td class="d2h-cntx">
                    <div class="d2h-code-line d2h-cntx">
                      <span class="d2h-code-line-prefix"> </span>
                      <span class="d2h-code-line-ctn"> get: [],</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-del">
                    <div class="line-num1">15</div>
                    <div class="line-num2"></div>
                  </td>
                  <td class="d2h-del">
                    <div class="d2h-code-line d2h-del">
                      <span class="d2h-code-line-prefix">-</span>
                      <span class="d2h-code-line-ctn"> create:
                        <del>[],</del>
                      </span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-del">
                    <div class="line-num1">16</div>
                    <div class="line-num2"></div>
                  </td>
                  <td class="d2h-del">
                    <div class="d2h-code-line d2h-del">
                      <span class="d2h-code-line-prefix">-</span>
                      <span class="d2h-code-line-ctn"> update:
                        <del>[],</del>
                      </span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-del">
                    <div class="line-num1">17</div>
                    <div class="line-num2"></div>
                  </td>
                  <td class="d2h-del">
                    <div class="d2h-code-line d2h-del">
                      <span class="d2h-code-line-prefix">-</span>
                      <span class="d2h-code-line-ctn"> patch:
                        <del>[],</del>
                      </span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-del">
                    <div class="line-num1">18</div>
                    <div class="line-num2"></div>
                  </td>
                  <td class="d2h-del">
                    <div class="d2h-code-line d2h-del">
                      <span class="d2h-code-line-prefix">-</span>
                      <span class="d2h-code-line-ctn"> remove:
                        <del>[]</del>
                      </span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">37</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn"> create:
                        <ins>[ process(), setCreatedAt() ],</ins>
                      </span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">38</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn"> update:
                        <ins>[ dePopulate(), restrictToSender() ],</ins>
                      </span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">39</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn"> patch:
                        <ins>[ dePopulate(), restrictToSender() ],</ins>
                      </span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">40</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn"> remove:
                        <ins>[ restrictToSenderOrServer ]</ins>
                      </span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-cntx">
                    <div class="line-num1">19</div>
                    <div class="line-num2">41</div>
                  </td>
                  <td class="d2h-cntx">
                    <div class="d2h-code-line d2h-cntx">
                      <span class="d2h-code-line-prefix"> </span>
                      <span class="d2h-code-line-ctn">};</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-cntx">
                    <div class="line-num1">20</div>
                    <div class="line-num2">42</div>
                  </td>
                  <td class="d2h-cntx">
                    <div class="d2h-code-line d2h-cntx">
                      <span class="d2h-code-line-prefix"> </span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-cntx">
                    <div class="line-num1">21</div>
                    <div class="line-num2">43</div>
                  </td>
                  <td class="d2h-cntx">
                    <div class="d2h-code-line d2h-cntx">
                      <span class="d2h-code-line-prefix"> </span>
                      <span class="d2h-code-line-ctn">exports.after = {</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-cntx">
                    <div class="line-num1">22</div>
                    <div class="line-num2">44</div>
                  </td>
                  <td class="d2h-cntx">
                    <div class="d2h-code-line d2h-cntx">
                      <span class="d2h-code-line-prefix"> </span>
                      <span class="d2h-code-line-ctn"> all: [],</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-del">
                    <div class="line-num1">23</div>
                    <div class="line-num2"></div>
                  </td>
                  <td class="d2h-del">
                    <div class="d2h-code-line d2h-del">
                      <span class="d2h-code-line-prefix">-</span>
                      <span class="d2h-code-line-ctn"> find:
                        <del>[],</del>
                      </span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-del">
                    <div class="line-num1">24</div>
                    <div class="line-num2"></div>
                  </td>
                  <td class="d2h-del">
                    <div class="d2h-code-line d2h-del">
                      <span class="d2h-code-line-prefix">-</span>
                      <span class="d2h-code-line-ctn"> get:
                        <del>[],</del>
                      </span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-del">
                    <div class="line-num1">25</div>
                    <div class="line-num2"></div>
                  </td>
                  <td class="d2h-del">
                    <div class="d2h-code-line d2h-del">
                      <span class="d2h-code-line-prefix">-</span>
                      <span class="d2h-code-line-ctn"> create:
                        <del>[],</del>
                      </span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">45</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn"> find:
                        <ins>[ populate({ schema: populateSchema }), serialize(serializeSchema) ],</ins>
                      </span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">46</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn"> get:
                        <ins>[ populate({ schema: populateSchema }), serialize(serializeSchema) ],</ins>
                      </span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-ins">
                    <div class="line-num1"></div>
                    <div class="line-num2">47</div>
                  </td>
                  <td class="d2h-ins">
                    <div class="d2h-code-line d2h-ins">
                      <span class="d2h-code-line-prefix">+</span>
                      <span class="d2h-code-line-ctn"> create:
                        <ins>[ populate({ schema: populateSchema }), serialize(serializeSchema) ],</ins>
                      </span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-cntx">
                    <div class="line-num1">26</div>
                    <div class="line-num2">48</div>
                  </td>
                  <td class="d2h-cntx">
                    <div class="d2h-code-line d2h-cntx">
                      <span class="d2h-code-line-prefix"> </span>
                      <span class="d2h-code-line-ctn"> update: [],</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-cntx">
                    <div class="line-num1">27</div>
                    <div class="line-num2">49</div>
                  </td>
                  <td class="d2h-cntx">
                    <div class="d2h-code-line d2h-cntx">
                      <span class="d2h-code-line-prefix"> </span>
                      <span class="d2h-code-line-ctn"> patch: [],</span>
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="d2h-code-linenumber d2h-cntx">
                    <div class="line-num1">28</div>
                    <div class="line-num2">50</div>
                  </td>
                  <td class="d2h-cntx">
                    <div class="d2h-code-line d2h-cntx">
                      <span class="d2h-code-line-prefix"> </span>
                      <span class="d2h-code-line-ctn"> remove: []</span>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <div id="d2h-154219" class="d2h-file-wrapper" data-lang="930000000 -0500">
        <div class="d2h-file-header">
          <span class="d2h-file-name-wrapper">
            <span class="d2h-icon-wrapper">
              <svg aria-hidden="true" class="d2h-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12">
                <path d="M6 5H2v-1h4v1zM2 8h7v-1H2v1z m0 2h7v-1H2v1z m0 2h7v-1H2v1z m10-7.5v9.5c0 0.55-0.45 1-1 1H1c-0.55 0-1-0.45-1-1V2c0-0.55 0.45-1 1-1h7.5l3.5 3.5z m-1 0.5L8 2H1v12h10V5z"></path>
              </svg>
            </span>
            <span class="d2h-file-name">server/{client/src/services/message/hooks/process.js 1969-12-31 19:00:00.000000000 -0500 → finish/src/services/message/hooks/process.js
              2017-01-03 11:12:35.930000000 -0500}</span>
            <span class="d2h-tag d2h-moved d2h-moved-tag">RENAMED</span>
          </span>
        </div>
        <div class="d2h-file-diff">
          <div class="d2h-code-wrapper">
            <table class="d2h-diff-table">
                <tbody class="d2h-diff-tbody">
                <tr>
    <td class="d2h-code-linenumber d2h-info"></td>
    <td class="d2h-info">
        <div class="d2h-code-line d2h-info">@@ -0,0 +1,15 @@</div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">1</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">'use strict';</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">2</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">3</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">// src/services/message/hooks/process.js</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">4</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">//</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">5</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">// Use this hook to manipulate incoming or outgoing data.</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">6</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">// For more information on hooks see: http://docs.feathersjs.com/hooks/readme.html</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">7</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">8</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">module.exports = () =&gt; context =&gt; {</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">9</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">  context.data.text = context.data.text</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">10</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    .substring(0, 400) // Messages can't be longer than 400 characters</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">11</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    .replace(/&amp;/g,'&amp;amp;').replace(/&lt;/g,'&amp;lt;').replace(/&gt;/g,'&amp;gt;'); // Do basic HTML escaping</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">12</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">  context.data.userId = context.params.user._id; // Add the authenticated user _id</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">13</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">  </span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">14</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">  return context;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">15</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">};</span>
        </div>
    </td>
</tr>
                </tbody>
            </table>
          </div>
        </div>
      </div>
      <div id="d2h-185000" class="d2h-file-wrapper" data-lang="918000000 -0500">
        <div class="d2h-file-header">
          <span class="d2h-file-name-wrapper">
            <span class="d2h-icon-wrapper">
              <svg aria-hidden="true" class="d2h-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12">
                <path d="M6 5H2v-1h4v1zM2 8h7v-1H2v1z m0 2h7v-1H2v1z m0 2h7v-1H2v1z m10-7.5v9.5c0 0.55-0.45 1-1 1H1c-0.55 0-1-0.45-1-1V2c0-0.55 0.45-1 1-1h7.5l3.5 3.5z m-1 0.5L8 2H1v12h10V5z"></path>
              </svg>
            </span>
            <span class="d2h-file-name">server/{client/src/services/message/hooks/restrict-to-sender.js 1969-12-31 19:00:00.000000000 -0500 → finish/src/services/message/hooks/restrict-to-sender.js
              2017-01-01 16:00:47.918000000 -0500}</span>
            <span class="d2h-tag d2h-moved d2h-moved-tag">RENAMED</span>
          </span>
        </div>
        <div class="d2h-file-diff">
          <div class="d2h-code-wrapper">
            <table class="d2h-diff-table">
                <tbody class="d2h-diff-tbody">
                <tr>
    <td class="d2h-code-linenumber d2h-info"></td>
    <td class="d2h-info">
        <div class="d2h-code-line d2h-info">@@ -0,0 +1,25 @@</div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">1</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">'use strict';</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">2</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">3</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">// src/services/message/hooks/restrict-to-sender.js</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">4</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">//</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">5</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">// Use this hook to manipulate incoming or outgoing data.</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">6</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">// For more information on hooks see: http://docs.feathersjs.com/hooks/readme.html</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">7</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">8</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">const errors = require('feathers-errors');</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">9</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">10</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">module.exports = function(options) {</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">11</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">  return function(context) {</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">12</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    const messageService = context.app.service('messages');</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">13</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    </span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">14</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    // First get the message that the user wants to access</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">15</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    return messageService.get(context.id, context.params).then(message =&gt; {</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">16</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">      // Throw a not authenticated error if the message and user id don't match</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">17</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">      if (message.sentBy._id !== context.params.user._id &amp;&amp; context.provider) {</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">18</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">        throw new errors.NotAuthenticated('Access not allowed');</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">19</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">      }</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">20</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">      </span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">21</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">      // Otherwise just return the context</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">22</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">      return context;</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">23</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    });</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">24</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">  };</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">25</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">};</span>
        </div>
    </td>
</tr>
                </tbody>
            </table>
          </div>
        </div>
      </div>
      <div id="d2h-933848" class="d2h-file-wrapper" data-lang="086000000 -0500">
        <div class="d2h-file-header">
          <span class="d2h-file-name-wrapper">
            <span class="d2h-icon-wrapper">
              <svg aria-hidden="true" class="d2h-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12">
                <path d="M6 5H2v-1h4v1zM2 8h7v-1H2v1z m0 2h7v-1H2v1z m0 2h7v-1H2v1z m10-7.5v9.5c0 0.55-0.45 1-1 1H1c-0.55 0-1-0.45-1-1V2c0-0.55 0.45-1 1-1h7.5l3.5 3.5z m-1 0.5L8 2H1v12h10V5z"></path>
              </svg>
            </span>
            <span class="d2h-file-name">server/{client/test/services/message/hooks/process.test.js 1969-12-31 19:00:00.000000000 -0500 → finish/test/services/message/hooks/process.test.js
              2017-01-01 13:38:18.086000000 -0500}</span>
            <span class="d2h-tag d2h-moved d2h-moved-tag">RENAMED</span>
          </span>
        </div>
        <div class="d2h-file-diff">
          <div class="d2h-code-wrapper">
            <table class="d2h-diff-table">
                <tbody class="d2h-diff-tbody">
                <tr>
    <td class="d2h-code-linenumber d2h-info"></td>
    <td class="d2h-info">
        <div class="d2h-code-line d2h-info">@@ -0,0 +1,20 @@</div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">1</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">'use strict';</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">2</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">3</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">const assert = require('assert');</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">4</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">const process = require('../../../../src/services/message/hooks/process.js');</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">5</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">6</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">describe('message process hook', function() {</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">7</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">  it('hook can be used', function() {</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">8</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    const mockContext = {</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">9</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">      type: 'before',</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">10</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">      app: {},</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">11</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">      params: {},</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">12</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">      result: {},</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">13</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">      data: {}</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">14</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    };</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">15</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">16</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    process()(mockContext);</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">17</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">18</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    assert.ok(mockContext.process);</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">19</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">  });</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">20</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">});</span>
        </div>
    </td>
</tr>
                </tbody>
            </table>
          </div>
        </div>
      </div>
      <div id="d2h-793450" class="d2h-file-wrapper" data-lang="014000000 -0500">
        <div class="d2h-file-header">
          <span class="d2h-file-name-wrapper">
            <span class="d2h-icon-wrapper">
              <svg aria-hidden="true" class="d2h-icon" height="16" version="1.1" viewBox="0 0 12 16" width="12">
                <path d="M6 5H2v-1h4v1zM2 8h7v-1H2v1z m0 2h7v-1H2v1z m0 2h7v-1H2v1z m10-7.5v9.5c0 0.55-0.45 1-1 1H1c-0.55 0-1-0.45-1-1V2c0-0.55 0.45-1 1-1h7.5l3.5 3.5z m-1 0.5L8 2H1v12h10V5z"></path>
              </svg>
            </span>
            <span class="d2h-file-name">server/{client/test/services/message/hooks/restrict-to-sender.test.js 1969-12-31 19:00:00.000000000 -0500 → finish/test/services/message/hooks/restrict-to-sender.test.js
              2017-01-01 15:56:40.014000000 -0500}</span>
            <span class="d2h-tag d2h-moved d2h-moved-tag">RENAMED</span>
          </span>
        </div>
        <div class="d2h-file-diff">
          <div class="d2h-code-wrapper">
            <table class="d2h-diff-table">
                <tbody class="d2h-diff-tbody">
                <tr>
    <td class="d2h-code-linenumber d2h-info"></td>
    <td class="d2h-info">
        <div class="d2h-code-line d2h-info">@@ -0,0 +1,20 @@</div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">1</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">'use strict';</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">2</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">3</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">const assert = require('assert');</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">4</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">const restrictToSender = require('../../../../src/services/message/hooks/restrict-to-sender.js');</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">5</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">6</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">describe('message restrictToSender hook', function() {</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">7</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">  it('hook can be used', function() {</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">8</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    const mockContext = {</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">9</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">      type: 'before',</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">10</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">      app: {},</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">11</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">      params: {},</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">12</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">      result: {},</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">13</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">      data: {}</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">14</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    };</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">15</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">16</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    restrictToSender()(mockContext);</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">17</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">18</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">    assert.ok(mockContext.restrictToSender);</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">19</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">  });</span>
        </div>
    </td>
</tr><tr>
    <td class="d2h-code-linenumber d2h-ins">
      <div class="line-num1"></div>
<div class="line-num2">20</div>
    </td>
    <td class="d2h-ins">
        <div class="d2h-code-line d2h-ins">
            <span class="d2h-code-line-prefix">+</span>
            <span class="d2h-code-line-ctn">});</span>
        </div>
    </td>
</tr>
                </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>

</html>
